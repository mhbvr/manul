syntax = "proto3";

package catphotos;

option go_package = "github.com/mhbvr/manul/proto";

service CatPhotosService {
  rpc ListCats(ListCatsRequest) returns (ListCatsResponse);
  rpc ListPhotos(ListPhotosRequest) returns (ListPhotosResponse);
  rpc GetPhoto(GetPhotoRequest) returns (GetPhotoResponse);
  rpc GetPhotosStream(GetPhotosStreamRequest) returns (stream GetPhotosStreamResponse);
}

message ListCatsRequest {
}

message ListCatsResponse {
  repeated uint64 cat_ids = 1;
}

message ListPhotosRequest {
  uint64 cat_id = 1;
}

message ListPhotosResponse {
  repeated uint64 photo_ids = 1;
}

enum ScalingAlgorithm {
  NONE = 0;
  NEAREST_NEIGHBOR = 1;
  BILINEAR = 2;
  CATMULL_ROM = 3;
  APPROX_BILINEAR = 4;
}

message GetPhotoRequest {
  uint64 cat_id = 1;
  uint64 photo_id = 2;
  uint32 width = 3;
  ScalingAlgorithm scaling_algorithm = 4;
}

message GetPhotoResponse {
  bytes photo_data = 1;
}

message PhotoRequest {
  uint64 cat_id = 1;
  uint64 photo_id = 2;
}

message GetPhotosStreamRequest {
  repeated PhotoRequest photo_requests = 1;
  uint32 width = 2;
  ScalingAlgorithm scaling_algorithm = 3;
}

message GetPhotosStreamResponse {
  uint64 cat_id = 1;
  uint64 photo_id = 2;
  bytes photo_data = 3;
  bool success = 4;
  string error_message = 5;
}